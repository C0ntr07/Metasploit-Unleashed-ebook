<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>auxiliary/scanner/smb/smb_enumshares</title>
<link rel="stylesheet" type="text/css" href="/home/steve/metasploit_unleashed/css.css" /></head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">auxiliary/scanner/smb/smb_enumshares</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">The smb_enumshares module, as would be
expected, enumerates any SMB shares that are available on a remote
system.
<br>
<br>
</p>
<pre id="code">msf &gt; use auxiliary/scanner/smb/smb_enumshares<br>msf auxiliary(smb_enumshares) &gt; show options<br><br>Module options:<br><br>   Name       Current Setting  Required  Description<br>   ----       ---------------  --------  -----------<br>   RHOSTS                      yes       The target address range or CIDR identifier<br>   SMBDomain  WORKGROUP        no        The Windows domain to use for authentication<br>   SMBPass                     no        The password for the specified username<br>   SMBUser                     no        The username to authenticate as<br>   THREADS    1                yes       The number of concurrent threads<br><br>msf auxiliary(smb_enumshares) &gt; set RHOSTS 192.168.1.150-165<br>RHOSTS =&gt; 192.168.1.150-165<br>msf auxiliary(smb_enumshares) &gt; set THREADS 16<br>THREADS =&gt; 16<br>msf auxiliary(smb_enumshares) &gt; run<br><br>[*] 192.168.1.154:139 print$ - Printer Drivers (DISK), tmp - oh noes! (DISK), opt -  (DISK), IPC$ - IPC Service (metasploitable server (Samba 3.0.20-Debian)) (IPC), ADMIN$ - IPC Service (metasploitable server (Samba 3.0.20-Debian)) (IPC)<br>Error: 192.168.1.160 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)<br>Error: 192.168.1.160 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)<br>[*] 192.168.1.161:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)<br>Error: 192.168.1.162 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)<br>Error: 192.168.1.150 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)<br>Error: 192.168.1.150 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)<br>[*] Scanned 06 of 16 hosts (037% complete)<br>[*] Scanned 09 of 16 hosts (056% complete)<br>[*] Scanned 10 of 16 hosts (062% complete)<br>[*] Scanned 14 of 16 hosts (087% complete)<br>[*] Scanned 15 of 16 hosts (093% complete)<br>[*] Scanned 16 of 16 hosts (100% complete)<br>[*] Auxiliary module execution completed<br>msf auxiliary(smb_enumshares) &gt;</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">As you can see, since this is an
un-credentialed scan, access is denied
a most of the systems that are probed. Passing user credentials to the
scanner will produce much different results.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<pre id="code">msf auxiliary(smb_enumshares) &gt; set SMBPass s3cr3t<br>SMBPass =&gt; s3cr3t<br>msf auxiliary(smb_enumshares) &gt; set SMBUser Administrator<br>SMBUser =&gt; Administrator<br>msf auxiliary(smb_enumshares) &gt; run<br><br>[*] 192.168.1.161:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)<br>[*] 192.168.1.160:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)<br>[*] 192.168.1.150:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)<br>[*] Scanned 06 of 16 hosts (037% complete)<br>[*] Scanned 07 of 16 hosts (043% complete)<br>[*] Scanned 12 of 16 hosts (075% complete)<br>[*] Scanned 15 of 16 hosts (093% complete)<br>[*] Scanned 16 of 16 hosts (100% complete)<br>[*] Auxiliary module execution completed<br>msf auxiliary(smb_enumshares) &gt;</pre>
<br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/SMB_Scanners"
 title="SMB Scanners">SMB Scanners</a></div>
</body>
</html>
