<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Metasploit Exploit Payloads</title>
</head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">Metasploit
Exploit Payloads</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">Select an encoder:
</p>
<dl style="color: rgb(0, 0, 0);">
  <dd>
    <ul>
      <li>Must not touch certain registers
      </li>
      <li>Must be under the max size
      </li>
      <li>Must avoid BadChars
      </li>
      <li>Encoders are ranked
      </li>
    </ul>
  </dd>
</dl>
<p style="color: rgb(0, 0, 0);">Select a nop generator:
</p>
<dl style="color: rgb(0, 0, 0);">
  <dd>
    <ul>
      <li>Tries the most random one first
      </li>
      <li>Nops are also ranked
      </li>
    </ul>
  </dd>
</dl>
<h4 style="color: rgb(0, 0, 0);"> <span class="mw-headline"
 id="Encoding_Example">Encoding Example</span></h4>
<dl style="color: rgb(0, 0, 0);">
  <dd>
    <ul>
      <li>The defined Payload Space is 900 bytes
      </li>
      <li>The Payload is 300 bytes long
      </li>
      <li>The Encoder stub adds another 40 bytes to the payload
      </li>
      <li>The Nops will then fill in the remaining 560 bytes bringing
the final payload.encoded size to 900 bytes
      </li>
      <li>The nop padding can be avoided by adding 'DisableNops' =&gt;
true to the exploit
      </li>
    </ul>
  </dd>
</dl>
<h4 style="color: rgb(0, 0, 0);"> <span class="mw-headline"
 id="Payload_Block_Options">Payload Block Options</span></h4>
<p style="color: rgb(0, 0, 0);">As is the case for most things in the
Framework, payloads can be tweaked by exploits.
</p>
<dl style="color: rgb(0, 0, 0);">
  <dd>
    <ul>
      <li>'StackAdjustment' prefixes "sub esp" code
      </li>
      <li>'MinNops', 'MaxNops', 'DisableNops'
      </li>
      <li>'Prefix' places data before the payload
      </li>
      <li>'PrefixEncoder' places it before the stub
      </li>
    </ul>
  </dd>
</dl>
<p style="color: rgb(0, 0, 0);">These options can also go into the
Targets block, allowing for
different BadChars for targets and allows Targets to hit different
architectures and OS.
<br>
<br>
</p>
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/Exploit_Development"
 title="Exploit Development">Exploit Development</a></div>
</body>
</html>
